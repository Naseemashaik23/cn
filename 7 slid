#include <stdio.h>

#define MAX_FRAMES 100

void send_frame(int n)   { 
 printf("Sender: Sent frame %d\n", n);
}
void receive_frame(int n){
 printf("Receiver: Received frame %d\n", n);
}
void send_ack(int n)     { 
 printf("Receiver: Ack sent for frame %d\n", n);
}
void receive_ack(int n)  { 
 printf("Sender: Ack received for frame %d\n", n); 
}
int main(void) {
    int total_frames, window_size;
    int base = 0, next = 0;
    int ack[MAX_FRAMES] = {0};

    printf("Enter total number of frames to send: ");
    if (scanf("%d", &total_frames) != 1) return 0;
    if (total_frames > MAX_FRAMES) total_frames = MAX_FRAMES;

    printf("Enter window size: ");
    if (scanf("%d", &window_size) != 1) return 0;

    while (base < total_frames) {
        while (next < base + window_size && next < total_frames) {
            if (!ack[next]) send_frame(next);
            next++;
        }
        int recv;
        printf("Enter received frame number (or -1 if lost): ");
        scanf("%d", &recv);
        if (recv >= 0 && recv < total_frames && !ack[recv]) {
            receive_frame(recv);
            send_ack(recv);
            ack[recv] = 1;
        }
        int ack_no;
        printf("Enter ack number received by sender (-1 if none): ");
        scanf("%d", &ack_no);
        if (ack_no >= 0 && ack_no < total_frames && ack[ack_no]) {
            receive_ack(ack_no);
        }
        while (base < total_frames && ack[base]) base++;
    }

    printf("All frames sent and acknowledged!\n");
    return 0;
}
